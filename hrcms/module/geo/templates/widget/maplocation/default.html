{% extends "widget/base.html" %}

{% block content %}
<div id="{{ widget.fe_identifier }}-map" class="widget-maplocation-map vspan-{% if widget.options.size.1 > 0 %}{{ widget.options.size.1 }}{% else %}6{% endif %}"></div>

<script type='text/javascript' src='http://maps.google.com/maps/api/js?sensor=true&amp;ver=3'></script>
<script type="text/javascript">
//<![CDATA[

(function($) {

	var canvas = $("#{{ widget.fe_identifier }}-map");
	var location = new google.maps.LatLng({{ widget.latitude }}, {{ widget.longitude }});
	var zoom = {{ widget.zoom }};

	{% if widget.map == 'roadmap' %}
	map_type = google.maps.MapTypeId.ROADMAP;
	{% endif %}

	{% if widget.map == 'satellite' %}
	map_type = google.maps.MapTypeId.SATELLITE;
	{% endif %}

	{% if widget.map == 'hybrid' %}
	map_type = google.maps.MapTypeId.HYBRID;
	{% endif %}

	var options = { zoom: zoom, center: location, mapTypeId: map_type };
	var map = new google.maps.Map(canvas.get(0), options);
	var marker = new google.maps.Marker({ position: location, map: map });

	{% if widget.title != '' %}
	{% if widget.description == '' %}
	var content = '<b>{{ widget.title }}</b>';
	{% else %}
	var content = '<b>{{ widget.title }}</b><br />{{ widget.description }}';
	{% endif %}
	var infoWindow = new google.maps.InfoWindow({content: content});
	infoWindow.open(map, marker);
	{% endif %}

	var fixMap = function() {
		google.maps.event.trigger(map, "resize");
		map.setCenter(location);
	}
//	alert('j');

//	alert('k');
	setTimeout(fixMap, 2000);

})(jQuery);

//]]>
</script>
{% endblock %}

